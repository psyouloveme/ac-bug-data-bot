var a=require("nodecg-io-core").requireService;module.exports=function(e){e.log.info("Animal Crossing Bug Data bundle started."),e.Replicant("databaseReady",{defaultValue:!1}),e.Replicant("acGameVersion",{defaultValue:"none"});const n=a(e,"sql");n.onAvailable((async a=>{!function(a,e){const n=a.Replicant("databaseReady");n.value=!1,a.log.info("Setting up Bug Data service."),a.listenFor("ChatReceived","twitch-listener",(({user:n,message:i})=>{if(!n||!i||!i.startsWith("!bug "))return;const t=i.split(" ").slice(1).join(" ").toLowerCase(),o=a.Replicant("acGameVersion");a.log.info("looking up bug data for",o.value),o.value,e("ac_bug_data").first("name","available","peak","time","location","spawn","rain").where("name",t).then((e=>{e?function(a,e){if(e&&e){let n=`${e.name}: available ${e.location} ${e.available}, ${e.time}.`;e.available!==e.peak&&(n+=` peaks in ${e.peak}.`),n+=` ${e.spawn} spawn rate (in this route)`,e.rain?n+=".":n+=" but not in rain.",a.sendMessageToBundle("SendChatMessage","twitch-listener",n)}}(a,e):a.log.info("no bug found,",t)}))})),a.log.info("Done setting up Bug Data service."),n.value=!0}(e,a)})),n.onUnavailable((async()=>function(a){a.log.info("Tearing down Animal Crossing Bug Data service."),a.Replicant("databaseReady").value=!1,a.log.info("Done tearing down Animal Crossing Bug Data service.")}(e)))};
//# sourceMappingURL=index.js.map
